@model covid192020.Models.ViewModels.TreatmentViewModel
@using covid192020.Models.ViewModels
@using covid192020.Infrastructure
@{
    ViewData["Title"] = "StatePatient";
    var PatientInfo = (PatientViewModel)ViewBag.PatientInfo;
    // var SelectListDiseasePeriod = (List<SelectListItem>)TempData["DiseasePeriod"];
    // var SelectListDiagnosis = (List<SelectListItem>)TempData["Diagnosis"];

}
@section Styles{
    <link rel="stylesheet" href="~/lib/bootstrap-select/dist/css/bootstrap-select.css" asp-append-version="true" />
    @*<link rel="stylesheet" href="~/lib/datetimpicker/build/jquery.datetimepicker.min.css" asp-append-version="true" />*@
}
<h2>Динамика пациента @PatientInfo.Fio</h2>
<hr />
@{var PatientId = ViewContext.RouteData.Values["PatientId"]; }
<div class="btn-group">
    <div style="width: 5px"></div>
    <a asp-area="" asp-controller="Patient" asp-action="AddEdit" asp-route-PatientId="@PatientId" class="btn btn-primary">
        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-pen" fill="currentColor">
            <path fill-rule="evenodd" d="M13.498.795l.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z" />
        </svg>
        Пациент
    </a>
    <div style="width: 5px"></div>
    <a asp-area="" asp-controller="Patient" asp-action="Summary" asp-route-PatientId="@PatientId" class="btn btn-primary">
        <svg width="16" height="16" fill="currentColor" class="bi bi-file-spreadsheet-fill" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M12 0H4a2 2 0 0 0-2 2v4h12V2a2 2 0 0 0-2-2zm2 7h-4v2h4V7zm0 3h-4v2h4v-2zm0 3h-4v3h2a2 2 0 0 0 2-2v-1zm-5 3v-3H6v3h3zm-4 0v-3H2v1a2 2 0 0 0 2 2h1zm-3-4h3v-2H2v2zm0-3h3V7H2v2zm4 0V7h3v2H6zm0 1h3v2H6v-2z" />
        </svg>
        Сводка
    </a>
    <div style="width: 5px"></div>
    <a asp-area="" asp-controller="Patient" asp-action="Treatment" asp-route-PatientId="@PatientId" class="btn btn-primary">
        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-person-lines-fill" fill="currentColor">
            <path fill-rule="evenodd" d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm7 1.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5zm0-3a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5zm2 9a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5z" />
        </svg>
        Динамика
    </a>
    @*<div style="width: 5px"></div>
        <a asp-area="" asp-controller="Patient" asp-action="Preparat" asp-route-PatientId="@PatientId" class="btn btn-primary">
            <svg width="16" height="16" fill="currentColor" class="bi bi-droplet-half" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M7.21.8C7.69.295 8 0 8 0c.109.363.234.708.371 1.038.812 1.946 2.073 3.35 3.197 4.6C12.878 7.096 14 8.345 14 10a6 6 0 0 1-12 0C2 6.668 5.58 2.517 7.21.8zm.413 1.021A31.25 31.25 0 0 0 5.794 3.99c-.726.95-1.436 2.008-1.96 3.07C3.304 8.133 3 9.138 3 10c0 0 2.5 1.5 5 .5s5-.5 5-.5c0-1.201-.796-2.157-2.181-3.7l-.03-.032C9.75 5.11 8.5 3.72 7.623 1.82z" />
                <path fill-rule="evenodd" d="M4.553 7.776c.82-1.641 1.717-2.753 2.093-3.13l.708.708c-.29.29-1.128 1.311-1.907 2.87l-.894-.448z" />
            </svg>
            Препараты
        </a>*@
</div>
<hr />

@* Анотация к пациенту *@
<table border="0" class="table pat">
    <thead class="table-dark">
        <tr>
            <td colspan="8">Общие данные</td>
        </tr>
        <tr>
            @*<td>Дата</td>*@
            <td>Болеет</td>
            <td>ВДНХ </td>
            <td>ОРИТ </td>
            <td>Возраст</td>
            <td>Вес</td>
            <td>
                Диагноз
            </td>
            <td>
                Вирус идентифицирован
            </td>
        </tr>
    </thead>
    <tr>
        @*<td>
                @CustomHelper.GetDateShortAndTime(DateTime.Now)
            </td>*@
        <td>@CustomHelper.GetDateShortAndTime(PatientInfo.DateInfected)<br /> @DateTime.Now.Subtract(PatientInfo.DateInfected).Days (сутки)</td>
        <td>@CustomHelper.GetDateShortAndTime(PatientInfo.DateAdmission)<br /> @DateTime.Now.Subtract(PatientInfo.DateAdmission).Days (сутки)</td>
        <td>@CustomHelper.GetDateShortAndTime(PatientInfo.DateOrit)<br /> @DateTime.Now.Subtract(PatientInfo.DateOrit).Days (сутки)</td>
        <td>@PatientInfo.Age</td>
        <td>@PatientInfo.Weight</td>
        <td style="width: 370px">
            <div>
                <select id="Diagnosis" asp-items="@ViewBag.Diagnosis" title="-- Выберите пункт --" class="form-control selectpicker" multiple>
                </select>
            </div>
        </td>
        <td>
            <!--<input id="VirusIdentification" type="checkbox" data-toggle-key-codes="[37,39]" />--> @* data-reverse checked*@
            <input type="date" data-date-inline-picker="true" class="form-control" />
        </td>
    </tr>
</table>
@*

    <form asp-controller="Patient" asp-action="AddPreparatPatient"
                         data-ajax="true"
                         data-ajax-method="POST"
                         data-ajax-mode="after"
                         data-ajax-update="#contr-preparapts"
                         data-ajax-begin="PreparatBegin"
                         data-ajax-success="PreparatSuccess">

*@


<form asp-area="" asp-controller="Patient" asp-action="Dinamic" method="post" asp-antiforgery="true">
    <table border="0" class="table pat">
        <thead class="table-dark">
            <tr>
                <td style="width: 91px">
                    Дата
                </td>
                <td>
                    PaO2/<br /> FiO2
                </td>
                <td>
                    SpO2
                </td>
                <td>
                    ЧДД
                </td>
                <td>
                    ПКТ
                </td>
                <td>
                    СРБ
                </td>
                <td>
                    WBC
                </td>
                <td>
                    PLT
                </td>
                <td>
                    Д-<br />Дим
                </td>
                <td>
                    Об.<br /> бел
                </td>
                <td>
                    Об.<br /> бил
                </td>
                <td>
                    Моч
                </td>
                <td>
                    Креат
                </td>
                <td>
                    Ф-<br />ген
                </td>
                <td>
                    АЛТ
                </td>
                <td>
                    АСТ
                </td>
                <td>
                    ЛДГ
                </td>
                <td>
                    Лимф<br /> оциты
                </td>
                <td>
                    Ферр<br /> итин
                </td>
                <td style="padding:0!important; width: 1px">
                    <button type="button" onclick="/*addDinamic()*/AddElement('contr-dinamics','input-dinamics', 30)" class="btn btn-primary" style="max-height: 100%">
                        <svg width="18" height="18" fill="currentColor" class="bi bi-plus-circle-fill" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z" />
                        </svg>
                    </button>
                </td>
            </tr>
        </thead>
        <tbody id="contr-dinamics" class="contr-dinamics">
            <tr id="input-dinamics" class="display-none">
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled type="date" class="form-control" />
                </td>
                <td>
                    <input asp-for="Dinamics[0].PaO2FiO2" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input asp-for="Dinamics[0].SpO2" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <input name="brtbfdfv[0].dfvd" disabled autocomplete="off" class="form-control" />
                </td>
                <td>
                    <button type="button" onclick="/*removeDinamic(this)*/RemoveElement(this, 'contr-dinamics','input-dinamics')" class="btn btn-danger">

                        <svg width="16" height="16" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z" />
                        </svg>
                    </button>
                    @*<button class="btn btn-primary" type="button" id="13" onclick="lockUnlock(this)" style="border: 0">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-unlock-fill" viewBox="0 0 16 16">
                                <path d="M.5 9a2 2 0 0 1 2-2h7a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2V9z" />
                                <path fill-rule="evenodd" d="M8.5 4a3.5 3.5 0 1 1 7 0v3h-1V4a2.5 2.5 0 0 0-5 0v3h-1V4z" />
                            </svg>
                        </button>*@
                </td>
            </tr>
        </tbody>
    </table>
    <table border="0" style="width: 100%">
        <tr>
            <td style="vertical-align: top; width: 100%">
                @* Препараты *@
                <table border="0" class="table">
                    <thead class="table-dark pat paddingTopBottom2">
                        <tr>
                            <td colspan="2">Назнавение препаратов</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding:0" colspan="2">
                                <div class="input-group ">
                                    @*<div class="input-group-prepend">
                                        <span class="input-group-text" style="border-radius: 0">
                                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-list-ol" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5z" />
                                                <path d="M1.713 11.865v-.474H2c.217 0 .363-.137.363-.317 0-.185-.158-.31-.361-.31-.223 0-.367.152-.373.31h-.59c.016-.467.373-.787.986-.787.588-.002.954.291.957.703a.595.595 0 0 1-.492.594v.033a.615.615 0 0 1 .569.631c.003.533-.502.8-1.051.8-.656 0-1-.37-1.008-.794h.582c.008.178.186.306.422.309.254 0 .424-.145.422-.35-.002-.195-.155-.348-.414-.348h-.3zm-.004-4.699h-.604v-.035c0-.408.295-.844.958-.844.583 0 .96.326.96.756 0 .389-.257.617-.476.848l-.537.572v.03h1.054V9H1.143v-.395l.957-.99c.138-.142.293-.304.293-.508 0-.18-.147-.32-.342-.32a.33.33 0 0 0-.342.338v.041zM2.564 5h-.635V2.924h-.031l-.598.42v-.567l.629-.443h.635V5z" />
                                            </svg>
                                        </span>
                                    </div>*@
                                    <input id="PrescriptionPreparat" class="form-control" placeholder="Назначение препаратами →" />
                                    <div class="input-group-prepend" style="padding-right: 1px">
                                        <button type="button" onclick="addPreparat()" class="btn btn-primary">
                                            <svg width="18" height="18" fill="currentColor" class="bi bi-plus-circle-fill" viewBox="0 0 16 16">
                                                <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                    <tr>
                        <td style="padding:0">
                            <table class="table pat">
                                <thead class="table-dark">
                                    <tr>
                                        <td style="width: 120px; ">Назначение</td>
                                        <td>Название</td>
                                        <td style="width: 120px; ">Отменен</td>
                                        
                                    </tr>
                                </thead>
                                <tbody id="contr_preparats">
                                </tbody>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
            @* KT *@
            <td style="vertical-align: top; min-width: 550px">
                <table border="0" class="table" style="margin-bottom: 0; width: 100%">
                    <thead class="table-dark pat paddingTopBottom2">
                        <tr>
                            <td colspan="2">КТ</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding:0" colspan="2">
                                <div class="input-group ">
                                    @*<div class="input-group-prepend">
                                        <span class="input-group-text" style="border-radius: 0">
                                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-list-ol" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5z" />
                                                <path d="M1.713 11.865v-.474H2c.217 0 .363-.137.363-.317 0-.185-.158-.31-.361-.31-.223 0-.367.152-.373.31h-.59c.016-.467.373-.787.986-.787.588-.002.954.291.957.703a.595.595 0 0 1-.492.594v.033a.615.615 0 0 1 .569.631c.003.533-.502.8-1.051.8-.656 0-1-.37-1.008-.794h.582c.008.178.186.306.422.309.254 0 .424-.145.422-.35-.002-.195-.155-.348-.414-.348h-.3zm-.004-4.699h-.604v-.035c0-.408.295-.844.958-.844.583 0 .96.326.96.756 0 .389-.257.617-.476.848l-.537.572v.03h1.054V9H1.143v-.395l.957-.99c.138-.142.293-.304.293-.508 0-.18-.147-.32-.342-.32a.33.33 0 0 0-.342.338v.041zM2.564 5h-.635V2.924h-.031l-.598.42v-.567l.629-.443h.635V5z" />
                                            </svg>
                                        </span>
                                    </div>*@
                                    <input id="KT" class="form-control" placeholder="" />
                                    <div class="input-group-prepend" style="padding-right: 1px">
                                        <button type="button" onclick="addKT()" class="btn btn-primary">
                                            <svg width="18" height="18" fill="currentColor" class="bi bi-plus-circle-fill" viewBox="0 0 16 16">
                                                <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </td>

                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td style="padding:0">
                                <table class="table pat">
                                    <thead class="table-dark pat">
                                        <tr>
                                            <td colspan="2">Исследования </td>

                                        </tr>
                                    </thead>
                                    <tbody id="contr_kt">
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                    </tfoot>
                </table>

            </td>

        </tr>
    </table>
    <div style=" text-align: center">
        <button type="submit" class="btn btn-success">Сохранить данные</button>
    </div>
</form>
@section Popper{
    <script src="~/lib/bootstrap-select/dist/popper.min.js"></script>
}
@section Scripts{

    @*<script src="~/lib/datetimpicker/build/jquery.datetimepicker.full.js"></script>*@
    @*<script src="~/js/moment.js"></script>*@
    <script src="~/lib/bootstrap-select/dist/js/bootstrap-select.js"></script>
    <script src="~/lib/bootstrap-select/dist/js/i18n/defaults-ru_RU.js"></script>

    <script src="~/lib/bootstrap-checkbox/dist/js/bootstrap-checkbox.js" asp-append-version="true"></script>
    <script src="~/lib/bootstrap-checkbox/dist/js/i18n/ru.js"></script>

    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js" asp-append-version="true"></script>
    <script src="~/lib/jquery-validation-unobtrusive/dist/jquery.validate.unobtrusive.min.js" asp-append-version="true"></script>

    <script src="~/lib/jquery-ajax-unobtrusive/dist/jquery.unobtrusive-ajax.min.js" asp-append-version="true"></script>
    <script>
        //function lockUnlock(obj) {
        //    var id = parseInt($(obj).attr('id'));

        //    $('.dinamic_input_' + id).attr('disabled', false);
        //    $(obj).attr('disabled', true);


        //}

        // <table, thead, tbody... id='_main_conteiner'>
        //   <tr id='_inputs_container'>
        //     <td> <input name='className[N].valueName'> </td>
        //     <td> <button onClick='AddElement(_main_conteiner, _inputs_container, 5)'>+</button>
        function AddElement(_main_conteiner, _inputs_container, max_count) {
            var main_conteiner = $('#' + _main_conteiner);
            var count = main_conteiner.find('.' + _inputs_container).length;
            console.log(count);
            if (max_count <= count) return false;

            var inputs_container = $('#' + _inputs_container).clone();
            inputs_container.removeAttr('id');
            inputs_container.addClass(_inputs_container);

            inputs_container.find('input').attr('disabled', false);
            inputs_container.removeClass('display-none');

            main_conteiner.append(inputs_container);

            var arr = main_conteiner.find('.' + _inputs_container);
            ReSetId(arr);
        }
        function RemoveElement(obj, _main_conteiner, _inputs_container) {
            $(obj).closest('tr').remove();
            var arr = $('#' + _main_conteiner).find('.' + _inputs_container);
            ReSetId(arr);
        }
        function ReSetId(conteiner_arr) {
            $.each(conteiner_arr, function (e, i) {
                var arrInput = $(i).find('input');
                $.each(arrInput, function (ee, ii) {
                    var t = $(ii).attr('name').replace(/\d+/, e);
                    $(ii).attr('name', t);
                })
            })
        }
        //function addDinamic() {
        //    var contr_dinamics = $('#contr-dinamics');
        //    var input_dinamic_disabled = $('#input-dinamics').clone();
        //    input_dinamic_disabled.removeAttr('id');
        //    input_dinamic_disabled.addClass('input-dinamics');
        //    var count = contr_dinamics.find('.input-dinamics').length;
        //    input_dinamic_disabled.find('input').attr('disabled', false);
        //    input_dinamic_disabled.removeClass('display-none');

        //    contr_dinamics.append(input_dinamic_disabled);

        //    var arr = contr_dinamics.find('.input-dinamics');
        //    $.each(arr, function (e, i) {
        //        var arrInput = $(i).find('input');
        //        $.each(arrInput, function (ee, ii) {
        //            var t = $(ii).attr('name').replace(/\d+/, e);
        //            $(ii).attr('name', t);
        //        })
        //    })
        //}
        //function removeDinamic(obj) {

        //    $(obj).closest('tr').remove();

        //    var contr_dinamics = $('#contr-dinamics');
        //    var arr = contr_dinamics.find('.input-dinamics');
        //    $.each(arr, function (e, i) {
        //        var arrInput = $(i).find('input');
        //        $.each(arrInput, function (ee, ii) {
        //            var t = $(ii).attr('name').replace(/\d+/, e);
        //            $(ii).attr('name', t);
        //        })
        //    })
        //}
        
        function addPreparat() {
            var conteiner = $('#contr_preparats');
            var prescriptionPreparat = $('#PrescriptionPreparat');
            if (prescriptionPreparat.val().trim() !== '') {
                var tr = "<tr><td style='text-align: center'>Сейчас</td><td>" + prescriptionPreparat.val().trim() + "</td><td class='padding0'><button onClick='remove(this)' class='btn btn-danger'>Удалить</button></td></tr>";
                conteiner.append(tr);

            }
            prescriptionPreparat.val('');
        }
        function addKT() {
            var conteiner = $('#contr_kt');
            var KT = $('#KT');
            if (KT.val().trim() !== '') {
                var tr = "<tr><td style='padding-left: 30px'>" + KT.val().trim() + "</td><td class='padding0'><input name='KTs[0].Id' type='hidden' value='0' ><input name='KTs[0].Value' type='hidden' value='" + KT.val().trim() + "' ><button onClick='remove(this)' class='btn btn-danger'>Удалить</button></td></tr>";
                conteiner.append(tr);

            }
            KT.val('');
        }
        function remove(obj) {
            $(obj).closest('tr').remove();
        }
        $('.selectpicker').selectpicker({
            selectedTextFormat: 'count > 3'
        });
            //$("#VirusIdentification").checkboxpicker({
            //    onLabel: 'Да',
            //    offLabel: 'Нет',
            //    onActiveCls: 'btn-danger',
            //    offActiveCls: 'btn-success',
            //    onCls: 'btn-outline-secondary',
            //    offCls: 'btn-outline-secondary'
            //});
    </script>
}
<style>
    .display-none {
        display: none
    }

    input, textarea {
        max-width: 100%;
    }
        /* Убрать стрелки у number полей */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

    table.pat td, thead.pat td, tbody.pat td {
        text-align: center;
        border: 1px solid lightgrey;
        vertical-align: middle;
        line-height: 1;
    }

    table.pat thead td, .paddingTopBottom2 td {
        font-size: 12px;
        font-weight: 700;
        padding-top: 2px;
        padding-bottom: 2px;
    }

    /*    .input-dinamics td{
        padding:0
    }
    .label-dinamic {
        font-size: 12px
    }*/

    .contr-dinamics td {
        vertical-align: middle;
        padding: 0px;
        border: 0
    }

    .contr-dinamics input {
        border: 0;
        box-shadow: none !important
    }

    .padding0 {
        padding: 0 !important;
        width: 1px !important;
        vertical-align: middle !important
    }

/*    .paddingTopBottom2 td {
        padding-top: 2px;
        padding-bottom: 2px;
    }*/

    .contr-dinamics input {
        padding-left: 3px;
        padding-right: 3px;
    }

    table.pat tbody {
        background: white
    }

    tbody.contr-dinamics input[type="date"] {
        max-width: 90px
    }

        tbody.contr-dinamics input[type="date"]::-webkit-inner-spin-button,
        tbody.contr-dinamics input[type="date"]::-webkit-calendar-picker-indicator {
            display: none;
            -webkit-appearance: none;
            /*  background: transparent;
            bottom: 0;
            color: transparent;
            cursor: pointer;
            height: auto;
            left: 0;
            position: absolute;
            right: 0;
            top: 0;
            width: auto;*/
        }
     input[type="date"]::-webkit-calendar-picker-indicator {
        color: rgba(0, 0, 0, 0);
        opacity: 0.9;
        display: block;
        cursor: pointer;
        background: url(/images/pngwing.png) no-repeat;
        width: 25px;
        height: 25px;
    }
</style>